CREATE TRIGGER [AddItem]
	ON [dbo].[BasketPositions]
AFTER INSERT
AS
BEGIN
    SET NOCOUNT ON;

    -- Sprawdzamy, czy dodany produkt jest aktywny
    IF EXISTS (SELECT 1 FROM inserted WHERE ID IN (SELECT ID FROM Product WHERE IsActive = 1))
    BEGIN
        -- Pobieramy ID nowo dodanego produktu
        DECLARE @NewProductID INT
        SELECT @NewProductID = ID FROM inserted

        -- Dodajemy nowy produkt do koszyka
        EXEC AddProductToBasket @ProductID = @NewProductID, @UserID = 1 -- Zakładamy, że UserID 1 oznacza użytkownika, który dodaje produkt do koszyka
    END
END;